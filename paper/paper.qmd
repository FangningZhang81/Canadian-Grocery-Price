---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - First author
  - Another author
thanks: "Code and data are available at: [https://github.com/RohanAlexander/starter_folder](https://github.com/RohanAlexander/starter_folder)."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(here)
library(knitr)

analysis_data <- read_csv(here::here("data/02-analysis_data/analysis_data.csv"))
```


# Introduction

Overview paragraph

Estimand paragraph

Results paragraph

Why it matters paragraph

Telegraphing paragraph: The remainder of this paper is structured as follows. @sec-data....






# Data {#sec-data}

## Overview

We use the statistical programming language R [@citeR].... Our data [@shelter].... Following @tellingstories, we consider...

Overview text

## Measurement
	
The measurement process involves transforming real-world phenomena into data that can be analyzed. In this case, the real-world phenomenon is the sale of potatoes by various vendors over time. Each transaction recorded in the raw dataset represents an instance of this phenomenon.

To transition from real-world sales events to a structured dataset, we began by recording each transaction, which included details like the product name and brand, prices, and the vendor information. This research focus on the single product-potato. Therefore, `product_name` was used to identify the specific types of potatoes (yellow and white), allowing us to focus on these items exclusively. The `current_price` and `old_price` fields represent the financial aspect of these sales, capturing both the price at the time of the transaction and the historical price for comparison.The `month` variable was derived from the transaction timestamp (`nowtime`) to provide a temporal context for analysis, allowing us to observe trends and patterns over different periods. 

By  filtering and cleaning the raw data, the dataset reflects the aspects of potato sales that are of interest for this study. This process of measurement transforms abstract sales activities into quantifiable data points that can be used for statistical analysis, providing insights into vendor behavior and price dynamics over time.

## Cleaning Process
The dataset used for this analysis comes from a combination of raw sales data and product-specific information, sourced from Project Hammer (https://jacobfilipp.com/hammer/). Project Hammer aims to drive more competition and reduce collusion in the Canadian grocery sector. The dataset, referred to as Canadian Grocery Price Data, includes sales data from eight vendors: Voila, T&T, Loblaws, No Frills, Metro, Galleria, Walmart, and Save-On-Foods. The available dates range from February 28, 2024, to the latest data load.

Initially, two raw datasets were downloaded from the Project Hammer website. These datasets were merged to create a comprehensive dataset containing all relevant columns, including `nowtime`, `vendor`, `product_id`, `product_name`, `brand`, `units`, `current_price`, `old_price`, `price_per_unit`, and `other`. 

The cleaning process involved several key steps to refine the dataset for analysis. First, we selected only the columns relevant to our study shown in @tbl-columns. The month of each transaction was extracted from the nowtime field to provide temporal context for the sales data.

```{r}
#| label: tbl-columns
#| tbl-cap: Summary of Selected Columns
#| echo: false
#| warning: false
#| message: false
columns <- data.frame(
  Column = c("nowtime", "vendor", "current_price", "old_price", "product_name"),
  Description = c(
    "Timestamp indicating when the data was gathered",
    "One of the 7 grocery vendors",
    "Price at time of extract",
    "An 'old' struck-out price, indicating a previous sale price",
    "Product name, may include brand and units"
  )
)

# Create a formatted table
kable(columns, caption = NULL)
```

Next, we filtered the dataset to include only the products of interest—yellow and white potatoes—by searching for these keywords in the product_name column, ensuring our analysis was focused specifically on these items. Additionally, any entries with missing values (NA) were removed to maintain data quality. Finally, the nowtime column was dropped after extracting the month, as it was no longer necessary for the analysis. @tbl-cleaned-data-preview gives an preview of the cleaned dataset we will use in the following sections.

```{r}
#| label: tbl-cleaned-data-preview
#| tbl-cap: Preview of Cleaned Data on Potato Sales
#| echo: false
#| warning: false
#| message: false

# Create table displaying the first few rows of cleaned data
kable(head(analysis_data), caption = NULL)
```

These steps resulted in a cleaned dataset containing the essential information needed for the analysis of potato sales trends.

## Outcome variables
The cleaned dataset contains 685 rows, representing individual products sold, along with vendor information and price details. The summary statistics of the cleaned data indicate that the mean of current price is 2.811, and the mean of old price is 3.785. @fig-vendor and @tbl-analysis-data-overview show that the cleaned dataset only contains five vendors instead of the eight in the raw dataset, and the month is from June to November. This is expected because data collection from February 28 to July 10/11 focused on a smaller set of products by the description of the raw dataset. After July, more products were added, and some data may be missing for certain vendors or days when extraction failed.

```{r}
#| label: tbl-analysis-data-overview
#| tbl-cap: Overview of Analysis Data
#| echo: false
#| warning: false
#| message: false

# Create summary statistics for numerical columns only
numerical_columns <- analysis_data %>% select(current_price, old_price, month)
summary_output <- summary(numerical_columns)

# Print the summary as a formatted table
kable(summary_output, caption = NULL)
```


```{r}
#| label: fig-vendor
#| fig-cap: "Total Number of Products by Vendor"
#| echo: false
#| warning: false
#| message: false

# Plot code
ggplot(analysis_data, aes(x = vendor)) +
  geom_bar(fill = "grey") +
  labs(
    x = "Vendor",
    y = "Total Products"
  ) +
  theme_minimal()

```


# Model

The goal of our modelling strategy is twofold. Firstly,...

Here we briefly describe the Bayesian analysis model used to investigate... Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up

Define $y_i$ as the number of seconds that the plane remained aloft. Then $\beta_i$ is the wing width and $\gamma_i$ is the wing length, both measured in millimeters.  

\begin{align} 
y_i|\mu_i, \sigma &\sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \alpha + \beta_i + \gamma_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta &\sim \mbox{Normal}(0, 2.5) \\
\gamma &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

Our results are summarized in @tbl-modelresults.





# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

Please don't use these as sub-heading labels - change them to be what your point actually is.

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 


## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...


\newpage


# References


